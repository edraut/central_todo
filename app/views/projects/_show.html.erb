<% sortable = false unless defined? sortable
	needs_organization = false unless defined? needs_organization %>
<%= form_for project, :url => plan_url(project), :html => {
	:'data-ajax_behavior' => 'ajax_form',
	:'data-ajax_method' => 'PUT',
	:'data-ajax_success_callback' => "handleArchivementLink();",
	:'data-ajax_error_callback' => "jQuery('#project_#{project.id}').append('<div class=\"flash_notice span-15 last\">Ooops! Something went wrong. We're looking into it, but feel free to contact customer support with any concerns.</div>'); setTimeout(\"jQuery('.flash_notice').fadeOut(1000)\",3000);",
	:'data-ajax_success_element' => "project_#{project.id}"} do |f| %>
	<div class="span-12">
		<div class="line_item_height span-8 last">
  		<%= link_to project.title, plan_url(project), :class => project.all_complete ? 'completed' : nil %>
		</div>
	</div>
	<div class="span-2 line_item_height text_center"><%= project.tasks.active.count %></div>
	<div class="span-2 last text_right">
		<a href="<%= plan_url(project) %>"
			data-ajax_behavior="ajax_link"
			data-ajax_method="DELETE"
			data-ajax_success_callback="jQuery('#project_<%= project.id %>').remove();handleListDisplay();"
			data-ajax_data="{_method: 'DELETE'}"
			data-ajax_confirm="<% if project.user_id == @this_user.id %>Are you sure you want to delete this plan?<% else %>This plan is being shared with you. Deleting it will not affect the owner's copy of the plan, it will only remove it from your list. Are you sure you want to remove this plan from your list?<% end %>"
			class="delete" data-role="delete">&otimes;</a>
		<% if sortable == true %>&nbsp;&nbsp;<span data-role="sortable_drag_handle" class="sortable_drag_handle">&equiv;</span><% end %>
		<%= hidden_field_tag ('sortable', true) if (controller_name == 'projects' or sortable == true) %>
		<%= hidden_field_tag 'partial', true %>
		<%= hidden_field_tag '_method', 'PUT' %>
	</div>
<% end %>
<% unless project.all_complete %>
<%= javascript_tag do %>
  jQuery(document).ready(function(){
    jQuery("[data-role='checkbox_placeholder']")
      .width(jQuery("[data-role='hidden_checkbox']").width());
  });
<% end %>
<% end %>